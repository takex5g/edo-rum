# 江戸走り検出のしくみ（かんたん解説）

## どうやって判定しているの？

カメラに映った人の姿勢を分析して、**3 つのポイント**をチェックしています。

---

### チェック 1: 腕の前後

左右の腕が**反対方向**に出ているかを見ています。

```
        進行方向 →

      ┌───┐
      │ 頭 │
      └─┬─┘
   ←───┼───→
  後ろ  体  前
（右腕）    （左腕）
```

**判定方法**: 手首が肩より「前」にあるか「後ろ」にあるかで判断

```
肩の位置 ────────────────────
              ↑
         手首がここより
         前なら「前に出ている」
         後ろなら「後ろに引いている」
```

**OK**: 片方の腕が前、もう片方が後ろ
**NG**: 両腕が同じ方向

---

### チェック 2: 足の前後

左右の足が**反対方向**に出ているかを見ています。

```
        進行方向 →

         体
         │
    ←────┼────→
   後ろ      前
 （右足）  （左足）
```

**判定方法**: 足指が腰より「前」にあるか「後ろ」にあるかで判断

**OK**: 片方の足が前、もう片方が後ろ
**NG**: 両足が同じ方向

---

### チェック 3: 膝の曲がり具合

両方の膝が**適度に曲がっている**かを見ています。

```
まっすぐ（NG）    曲がっている（OK）

    |                 /
    |                /
    |               <  ← 膝が曲がっている
    |                \
    |                 \
```

**OK**: 膝が 165 度より曲がっている
**NG**: 膝がまっすぐ伸びている

---

## 体の向きの判定

人がどちらを向いているかを自動で判定します。

```
【右向き】              【左向き】
左肩が右側にある        右肩が左側にある

    ← 進行方向              進行方向 →
```

これにより、右向きでも左向きでも正しく判定できます。

---

## 判定の流れ

```
┌────────────────────────────────────┐
│  カメラで体の動きを撮影            │
└─────────────┬──────────────────────┘
              ▼
┌────────────────────────────────────┐
│  AIが体の関節の位置を検出          │
│  （肩・手首・腰・膝・足首など）     │
└─────────────┬──────────────────────┘
              ▼
┌────────────────────────────────────┐
│  体の向き（右向き/左向き）を判定    │
└─────────────┬──────────────────────┘
              ▼
┌────────────────────────────────────┐
│  3つの条件をチェック               │
│  □ 腕が前後に対向しているか        │
│  □ 足が前後に対向しているか        │
│  □ 膝が曲がっているか              │
└─────────────┬──────────────────────┘
              ▼
        ┌─────┴─────┐
        ▼           ▼
   【3つともOK】  【1つでもNG】
        │           │
        ▼           ▼
   ┌─────────┐  ┌─────────┐
   │江戸走り！│  │ちがうよ │
   │（緑表示）│  │（赤表示）│
   └─────────┘  └─────────┘
```

## 画面の見方

判定中は画面に結果が表示されます。

| 表示       | 意味                            |
| ---------- | ------------------------------- |
| 緑色の矢印 | その腕/足は「前」に出ている     |
| 赤色の矢印 | その腕/足は「後ろ」に引いている |
| 緑色の円弧 | 膝が十分曲がっている            |
| 赤色の円弧 | 膝が伸びすぎている              |

**すべてが条件を満たすと「江戸走り」と判定されます。**

---

## よくある質問

### Q: なぜ 1 秒待たないと判定されないの？

一瞬だけ条件を満たしても、それはたまたまかもしれません。
**1 秒間キープ**することで、本当に江戸走りのフォームができているか確認しています。

### Q: うまく判定されないときは？

- カメラに**全身が映る**ようにしてください
- **横向き**で撮影してください（正面だと前後がわかりません）
- **明るい場所**で撮影してください
- **ゆっくり動いて**ポーズを確認してみてください

### Q: 膝の 165 度ってどれくらい？

ほぼまっすぐ（180 度）よりも、**少し曲がっている**状態です。
軽く膝を緩める程度で大丈夫です。

### Q: 「外旋」「内旋」って何？

- **外旋（緑）**: 腕や足が「前」に出ている状態
- **内旋（赤）**: 腕や足が「後ろ」に引いている状態

江戸走りでは、左右で反対（一方が外旋、もう一方が内旋）になっている必要があります。
